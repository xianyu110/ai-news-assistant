import{d as e,r as a,c as t,o as l,a as s,b as c,e as u,s as n,g as o,f as i,w as r,i as d,h as f,j as g,k as v,l as _,m as h,n as m,t as b,p as y,q as w,F as p,u as k,v as C,x as D,y as I,z as T,A as S,B as F}from"./index-DLIFowN9.js";import{N as $,L as x,_ as A}from"./_plugin-vue_export-helper.B_pJ9-iT.js";const z=3e5,M=A(e({__name:"news-list",setup(e){const A=a(!1),M=a(!1),N=a([]),O=a({totalCount:0,todayCount:0,categories:[],sources:[]}),j=a(Date.now()),E=a(1),B=a(20),L=a(!0),R=a(null),H=a(!0),J=a(!1),U=a({cacheTime:"",dataSource:"",nextRefresh:""}),q=t(()=>{const e={};N.value.forEach(a=>{const t=new Date(a.publishTime),l=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`;e[l]||(e[l]=[]),e[l].push(a)});const a=Object.keys(e).sort((e,a)=>a.localeCompare(e)),t={};return a.forEach(a=>{t[a]=e[a].sort((e,a)=>new Date(a.publishTime).getTime()-new Date(e.publishTime).getTime())}),t});l(async()=>{await Q(),P(),ue(),s(()=>{H.value=!0,P(),ue()}),c(()=>{H.value=!1,K(),ue()}),setInterval(ue,3e4)}),u(()=>{K()});const P=()=>{K(),R.value=setInterval(async()=>{if(H.value){console.log("üîÑ Ëá™Âä®Âà∑Êñ∞Êï∞ÊçÆ...");try{const e=await $.getNews();if(e.success&&e.data.length>0){const a=Y();if(G(e)!==a){console.log("üÜï Ê£ÄÊµãÂà∞Êï∞ÊçÆÂèòÂåñÔºåÂºÄÂßãÊõ¥Êñ∞...");e.data;j.value=new Date(e.updateTime).getTime(),await W(1,!0),n({title:"ÂèëÁé∞Êñ∞ÂÜÖÂÆπ",icon:"success",duration:1500})}else console.log("üìÑ Êï∞ÊçÆÊó†ÂèòÂåñÔºå‰øùÊåÅÂΩìÂâçÁä∂ÊÄÅ")}}catch(e){console.log("Ëá™Âä®Âà∑Êñ∞Â§±Ë¥•:",e)}}},z)},Y=()=>{var e,a;try{const t=JSON.stringify({count:N.value.length,firstItemId:null==(e=N.value[0])?void 0:e.id,lastItemId:null==(a=N.value[N.value.length-1])?void 0:a.id,updateTime:j.value});let l=0;for(let e=0;e<t.length;e++){l=(l<<5)-l+t.charCodeAt(e),l&=l}return l.toString()}catch(t){return""}},G=e=>{var a,t,l,s,c,u;try{const n=JSON.stringify({count:e.count||0,updateTime:e.updateTime,firstItemId:null==(t=null==(a=e.data)?void 0:a[0])?void 0:t.id,lastItemId:null==(c=null==(s=e.data)?void 0:s[(null==(l=e.data)?void 0:l.length)-1])?void 0:c.id,dataLength:(null==(u=e.data)?void 0:u.length)||0});let o=0;for(let e=0;e<n.length;e++){o=(o<<5)-o+n.charCodeAt(e),o&=o}return o.toString()}catch(n){return""}},K=()=>{R.value&&(clearInterval(R.value),R.value=null)},Q=async()=>{try{await Promise.all([W(),X()])}catch(e){console.error("ÂàùÂßãÂåñÂ§±Ë¥•:",e),n({title:"ÂàùÂßãÂåñÂ§±Ë¥•",icon:"error"})}},V=async()=>{console.log("üîÑ ÊâãÂä®Âà∑Êñ∞Êñ∞ÈóªÊï∞ÊçÆ..."),E.value=1;try{I("newsData"),I("lastUpdateTime"),I("lastDataHash"),console.log("üßπ Â∑≤Ê∏ÖÈô§Êú¨Âú∞ÁºìÂ≠ò"),await W(1,!0),await X(),n({title:"Êï∞ÊçÆÂ∑≤Êõ¥Êñ∞",icon:"success",duration:2e3}),console.log("‚úÖ ÊâãÂä®Âà∑Êñ∞ÂÆåÊàê")}catch(e){console.error("‚ùå ÊâãÂä®Âà∑Êñ∞Â§±Ë¥•:",e),n({title:"Âà∑Êñ∞Â§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï",icon:"error",duration:2e3})}},W=async(e=1,a=!1)=>{1===e?(A.value=!0,N.value=[],E.value=1,L.value=!0):M.value=!0;try{console.log("üì∞ ÂºÄÂßãÂä†ËΩΩÊñ∞ÈóªÊï∞ÊçÆ...");const t=await $.getNews(a);if(!t.success)throw new Error(t.error||"Âä†ËΩΩÂ§±Ë¥•");{const a=t.data||[];j.value=new Date(t.updateTime).getTime();const l=(e-1)*B.value,s=l+B.value,c=a.slice(l,s);N.value=1===e?c:[...N.value,...c],L.value=s<a.length,await Z(),console.log(`‚úÖ ÊàêÂäüÂä†ËΩΩ ${c.length} Êù°Êñ∞ÈóªÔºåÊÄªËÆ° ${N.value.length} Êù°`),1===e&&c.length>0&&n({title:`Â∑≤Âä†ËΩΩ ${c.length} Êù°ÊúÄÊñ∞Âø´ËÆØ`,icon:"success",duration:2e3})}}catch(t){console.error("‚ùå Âä†ËΩΩÊñ∞ÈóªÂ§±Ë¥•:",t),n({title:"Âä†ËΩΩÂ§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï",icon:"error"})}finally{A.value=!1,M.value=!1}},X=async()=>{try{const e=await $.getNews();e.success&&(O.value=e.stats,console.log("üìä ÁªüËÆ°‰ø°ÊÅØÂä†ËΩΩÊàêÂäü:",e.stats))}catch(e){console.error("‚ùå Âä†ËΩΩÁªüËÆ°Â§±Ë¥•:",e)}},Z=async()=>{try{N.value.forEach(e=>{e.isFavorited=x.isFavorited(e.id)}),console.log("‚úÖ Êî∂ËóèÁä∂ÊÄÅÂä†ËΩΩÊàêÂäü")}catch(e){console.error("‚ùå Âä†ËΩΩÊî∂ËóèÁä∂ÊÄÅÂ§±Ë¥•:",e)}},ee=()=>{T({url:"/pages/ai-news/search"})},ae=()=>{S({title:"ÂÖ≥Ê≥®ÂÖ¨‰ºóÂè∑",content:"ËØ∑Âú®ÂæÆ‰ø°ÊêúÁ¥¢Âπ∂ÂÖ≥Ê≥®ÂÖ¨‰ºóÂè∑„ÄåMaynorAI„ÄçÔºåËé∑ÂèñÊõ¥Â§ö‰∏ÄÊâãAIËµÑËÆØÂíåÂ∑•ÂÖ∑„ÄÇ",showCancel:!1})},te=e=>{const a=new Date(e),t=new Date,l=new Date(t.getTime()-864e5),s=a.getMonth()+1,c=a.getDate(),u=["Âë®Êó•","Âë®‰∏Ä","Âë®‰∫å","Âë®‰∏â","Âë®Âõõ","Âë®‰∫î","Âë®ÂÖ≠"][a.getDay()];return e===t.toISOString().split("T")[0]?`‰ªäÂ§©¬∑${u}`:e===l.toISOString().split("T")[0]?`Êò®Â§©¬∑${u}`:`${s}Êúà${c}Êó•¬∑${u}`},le=e=>{if(!e)return"";const a=new Date(e);return`${String(a.getHours()).padStart(2,"0")}:${String(a.getMinutes()).padStart(2,"0")}`},se=()=>{F(),n({title:"Â∑≤Ê∏ÖÈô§ÊâÄÊúâÁºìÂ≠ò",icon:"success"}),console.log("üßπ Â∑≤Ê∏ÖÈô§ÊâÄÊúâÁºìÂ≠ò"),j.value=Date.now(),V()},ce=()=>{console.log("üîÑ ÊâãÂä®Ëß¶ÂèëËá™Âä®Âà∑Êñ∞..."),P(),n({title:"Â∑≤ÊâãÂä®Ëß¶ÂèëËá™Âä®Âà∑Êñ∞",icon:"success"})},ue=()=>{try{const e=o("lastUpdateTime");U.value.cacheTime=e?new Date(e).toLocaleString():"Êó†ÁºìÂ≠ò",U.value.dataSource=o("newsData")?"Êú¨Âú∞ÁºìÂ≠ò":"Á≠âÂæÖËé∑Âèñ",U.value.nextRefresh=R.value?`${Math.ceil(5)}ÂàÜÈíüÂêé`:"Â∑≤ÂÅúÊ≠¢"}catch(e){console.error("Êõ¥Êñ∞Ë∞ÉËØï‰ø°ÊÅØÂ§±Ë¥•:",e)}};return(e,a)=>{const t=d,l=m,s=f("uni-icons"),c=y;return g(),i(t,{class:"news-container"},{default:r(()=>[v(t,{class:"header-banner"},{default:r(()=>[v(t,{class:"banner-bg"},{default:r(()=>[v(t,{class:"banner-content"},{default:r(()=>[v(t,{class:"banner-icon"},{default:r(()=>[v(t,{class:"news-icon"},{default:r(()=>[h("üì∞")]),_:1})]),_:1}),v(t,{class:"banner-text"},{default:r(()=>[v(t,{class:"banner-title"},{default:r(()=>[h("ÊØèÊó•AIÂø´ËÆØ")]),_:1}),v(t,{class:"banner-subtitle"},{default:r(()=>[h("AIË°å‰∏öËµÑËÆØ | ÁÉ≠ÁÇπ | ËûçËµÑ | ‰∫ßÂìÅÂä®ÊÄÅ")]),_:1})]),_:1})]),_:1})]),_:1}),v(t,{class:"description"},{default:r(()=>[h(" AIÂ∑•ÂÖ∑ÈõÜÊØèÊó•ÂÆûÊó∂Êõ¥Êñ∞ AI Ë°å‰∏öÁöÑÊúÄÊñ∞ËµÑËÆØ„ÄÅÊñ∞Èóª„ÄÅÁÉ≠ÁÇπ„ÄÅËûçËµÑ„ÄÅ‰∫ßÂìÅÂä®ÊÄÅ„ÄÅÁàÜÊñôÁ≠âÔºåËÆ©‰Ω†ÈöèÊó∂‰∫ÜËß£‰∫∫Â∑•Êô∫ËÉΩÈ¢ÜÂüüÊúÄÊñ∞Ë∂ãÂäø„ÄÅÊõ¥Êñ∞Á™ÅÁ†¥ÂíåÁÉ≠Èó®Â§ß‰∫ã‰ª∂„ÄÇ "),v(l,{class:"highlight",onClick:ae},{default:r(()=>[h("ÂÖ≥Ê≥®ÂÖ¨‰ºóÂè∑ MaynorAI")]),_:1}),h(" ÔºåËé∑ÂèñÊúÄÊñ∞‰∏ÄÊâã‰ø°ÊÅØÔºÅ ")]),_:1})]),_:1}),v(t,{class:"search-section"},{default:r(()=>[v(t,{class:"search-box",onClick:ee},{default:r(()=>[v(s,{type:"search",size:"16",color:"#999"}),v(l,{class:"search-placeholder"},{default:r(()=>[h("ËæìÂÖ•ÂÖ≥ÈîÆËØçÊêúÁ¥¢ÂÆö‰Ωç(Á≤æÁ°ÆÂåπÈÖç)")]),_:1})]),_:1})]),_:1}),O.value.totalCount>0?(g(),i(t,{key:0,class:"stats-section"},{default:r(()=>[v(t,{class:"stats-item"},{default:r(()=>[v(l,{class:"stats-number"},{default:r(()=>[h(b(O.value.totalCount),1)]),_:1}),v(l,{class:"stats-label"},{default:r(()=>[h("ÊÄªÂø´ËÆØ")]),_:1})]),_:1}),v(t,{class:"stats-item"},{default:r(()=>[v(l,{class:"stats-number"},{default:r(()=>[h(b(O.value.todayCount),1)]),_:1}),v(l,{class:"stats-label"},{default:r(()=>[h("‰ªäÊó•Êñ∞Â¢û")]),_:1})]),_:1}),v(t,{class:"stats-item"},{default:r(()=>[v(l,{class:"stats-number"},{default:r(()=>[h(b(Math.ceil((Date.now()-j.value)/1e3/60)),1)]),_:1}),v(l,{class:"stats-label"},{default:r(()=>[h("ÂàÜÈíüÂâçÊõ¥Êñ∞")]),_:1})]),_:1}),v(t,{class:"stats-item",onClick:a[0]||(a[0]=e=>J.value=!J.value)},{default:r(()=>[v(l,{class:"stats-number"},{default:r(()=>[h("üîß")]),_:1}),v(l,{class:"stats-label"},{default:r(()=>[h("Ë∞ÉËØï‰ø°ÊÅØ")]),_:1})]),_:1})]),_:1})):_("",!0),J.value?(g(),i(t,{key:1,class:"debug-panel"},{default:r(()=>[v(t,{class:"debug-title"},{default:r(()=>[h("üîß Ë∞ÉËØï‰ø°ÊÅØ")]),_:1}),v(t,{class:"debug-item"},{default:r(()=>[v(l,{class:"debug-label"},{default:r(()=>[h("Ëá™Âä®Âà∑Êñ∞Áä∂ÊÄÅ:")]),_:1}),v(l,{class:"debug-value"},{default:r(()=>[h(b(R.value?"ËøêË°å‰∏≠":"Â∑≤ÂÅúÊ≠¢"),1)]),_:1})]),_:1}),v(t,{class:"debug-item"},{default:r(()=>[v(l,{class:"debug-label"},{default:r(()=>[h("È°µÈù¢ÂèØËßÅÁä∂ÊÄÅ:")]),_:1}),v(l,{class:"debug-value"},{default:r(()=>[h(b(H.value?"ÂèØËßÅ":"ÈöêËóè"),1)]),_:1})]),_:1}),v(t,{class:"debug-item"},{default:r(()=>[v(l,{class:"debug-label"},{default:r(()=>[h("ÁºìÂ≠òÊõ¥Êñ∞Êó∂Èó¥:")]),_:1}),v(l,{class:"debug-value"},{default:r(()=>[h(b(U.value.cacheTime),1)]),_:1})]),_:1}),v(t,{class:"debug-item"},{default:r(()=>[v(l,{class:"debug-label"},{default:r(()=>[h("Êï∞ÊçÆÊù•Ê∫ê:")]),_:1}),v(l,{class:"debug-value"},{default:r(()=>[h(b(U.value.dataSource),1)]),_:1})]),_:1}),v(t,{class:"debug-item"},{default:r(()=>[v(l,{class:"debug-label"},{default:r(()=>[h("‰∏ãÊ¨°Âà∑Êñ∞:")]),_:1}),v(l,{class:"debug-value"},{default:r(()=>[h(b(U.value.nextRefresh),1)]),_:1})]),_:1}),v(t,{class:"debug-actions"},{default:r(()=>[v(c,{class:"debug-btn",onClick:se},{default:r(()=>[h("Ê∏ÖÈô§ÁºìÂ≠ò")]),_:1}),v(c,{class:"debug-btn",onClick:ce},{default:r(()=>[h("ÊµãËØïÂà∑Êñ∞")]),_:1})]),_:1})]),_:1})):_("",!0),A.value&&0===N.value.length?(g(),i(t,{key:2,class:"loading-state"},{default:r(()=>[v(s,{type:"spinner-cycle",size:"30",color:"#4285F4"}),v(l,{class:"loading-text"},{default:r(()=>[h("Ê≠£Âú®Âä†ËΩΩÊúÄÊñ∞Âø´ËÆØ...")]),_:1})]),_:1})):_("",!0),!A.value||N.value.length>0?(g(),i(t,{key:3,class:"news-list"},{default:r(()=>[(g(!0),w(p,null,k(q.value,(e,a)=>(g(),i(t,{key:a,class:"date-group"},{default:r(()=>[v(t,{class:"date-header"},{default:r(()=>[v(t,{class:"date-indicator"}),v(l,{class:"date-text"},{default:r(()=>[h(b(te(a)),1)]),_:2},1024)]),_:2},1024),v(t,{class:"date-news-list"},{default:r(()=>[(g(!0),w(p,null,k(e,(e,a)=>(g(),i(t,{key:e.id,class:"news-item",onClick:a=>(e=>{T({url:`/pages/ai-news/news-detail?id=${e.id}`})})(e)},{default:r(()=>[v(t,{class:"news-content"},{default:r(()=>[v(t,{class:"news-title"},{default:r(()=>[h(b(e.title),1)]),_:2},1024),v(t,{class:"news-meta"},{default:r(()=>[v(l,{class:"news-source"},{default:r(()=>[h("Êù•Ê∫êÔºö"+b(e.source),1)]),_:2},1024),v(l,{class:"news-time"},{default:r(()=>[h(b(le(e.publishTime)),1)]),_:2},1024)]),_:2},1024),e.tags&&e.tags.length>0?(g(),i(t,{key:0,class:"news-tags"},{default:r(()=>[(g(!0),w(p,null,k(e.tags.slice(0,3),e=>(g(),i(l,{key:e,class:"news-tag"},{default:r(()=>[h(b(e),1)]),_:2},1024))),128))]),_:2},1024)):_("",!0)]),_:2},1024),v(t,{class:"news-actions"},{default:r(()=>[v(t,{class:D(["favorite-btn",{favorited:e.isFavorited}]),onClick:C(a=>(e=>{try{e.isFavorited?(x.removeFavorite(e.id),e.isFavorited=!1,n({title:"Â∑≤ÂèñÊ∂àÊî∂Ëóè",icon:"success"})):(x.saveFavorite(e),e.isFavorited=!0,n({title:"Â∑≤Êî∂Ëóè",icon:"success"}))}catch(a){console.error("‚ùå Êî∂ËóèÊìç‰ΩúÂ§±Ë¥•:",a),n({title:"Êìç‰ΩúÂ§±Ë¥•",icon:"error"})}})(e),["stop"])},{default:r(()=>[v(s,{type:e.isFavorited?"heart-filled":"heart",color:e.isFavorited?"#FF6B6B":"#CCC",size:"16"},null,8,["type","color"])]),_:2},1032,["class","onClick"])]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1})):_("",!0),M.value?(g(),i(t,{key:4,class:"load-more"},{default:r(()=>[v(s,{type:"spinner-cycle",size:"20",color:"#4285F4"}),v(l,{class:"load-more-text"},{default:r(()=>[h("Ê≠£Âú®Âä†ËΩΩÊõ¥Â§ö...")]),_:1})]),_:1})):_("",!0),!L.value&&N.value.length>0?(g(),i(t,{key:5,class:"no-more"},{default:r(()=>[v(l,{class:"no-more-text"},{default:r(()=>[h("‚Äî Â∑≤Âä†ËΩΩÂÖ®ÈÉ®Âø´ËÆØ ‚Äî")]),_:1})]),_:1})):_("",!0),A.value||0!==N.value.length?_("",!0):(g(),i(t,{key:6,class:"empty-state"},{default:r(()=>[v(s,{type:"info",size:"60",color:"#DDD"}),v(l,{class:"empty-text"},{default:r(()=>[h("ÊöÇÊó†Âø´ËÆØÊï∞ÊçÆ")]),_:1}),v(c,{class:"refresh-btn",onClick:V},{default:r(()=>[h("Âà∑Êñ∞ËØïËØï")]),_:1})]),_:1})),A.value?_("",!0):(g(),i(t,{key:7,class:"floating-refresh",onClick:V},{default:r(()=>[v(s,{type:"refresh",size:"20",color:"#4285F4"})]),_:1}))]),_:1})}}}),[["__scopeId","data-v-5cded802"]]);export{M as default};
