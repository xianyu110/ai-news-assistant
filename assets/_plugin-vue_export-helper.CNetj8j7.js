import{E as t,J as e,G as a,_ as r,H as o}from"./index-y3w81WhB.js";const s="/data/ai-news.json",c={key:"newsData",updateKey:"lastUpdateTime",expireTime:3e5};class i{static saveFavorite(t){try{const e=this.getFavorites();return!e.find(e=>e.id===t.id)&&(e.push({id:t.id,title:t.title,category:t.category,createTime:(new Date).toISOString()}),a("favorites",e),!0)}catch(e){return console.error("ä¿å­˜æ”¶è—å¤±è´¥:",e),!1}}static removeFavorite(t){try{const e=this.getFavorites().filter(e=>e.id!==t);return a("favorites",e),!0}catch(e){return console.error("ç§»é™¤æ”¶è—å¤±è´¥:",e),!1}}static getFavorites(){try{return t("favorites")||[]}catch(e){return console.error("èŽ·å–æ”¶è—å¤±è´¥:",e),[]}}static isFavorited(t){try{return this.getFavorites().some(e=>e.id===t)}catch(e){return!1}}static saveSearchHistory(t){try{if(!t.trim())return;let e=this.getSearchHistory();e=e.filter(e=>e!==t),e.unshift(t),e.length>10&&(e=e.slice(0,10)),a("searchHistory",e)}catch(e){console.error("ä¿å­˜æœç´¢åŽ†å²å¤±è´¥:",e)}}static getSearchHistory(){try{return t("searchHistory")||[]}catch(e){return[]}}static clearSearchHistory(){try{o("searchHistory")}catch(t){console.error("æ¸…é™¤æœç´¢åŽ†å²å¤±è´¥:",t)}}static isCacheExpired(){try{const e=t(c.updateKey);if(!e)return!0;const a=Date.now();return a>e+c.expireTime}catch(e){return!0}}static updateCacheTime(){try{a(c.updateKey,Date.now())}catch(t){console.error("æ›´æ–°ç¼“å­˜æ—¶é—´å¤±è´¥:",t)}}}class n{static async getNews(o=!1){try{console.log("ðŸ”„ å¼€å§‹èŽ·å–æ–°é—»æ•°æ®...",{forceRefresh:o});if(!(o||i.isCacheExpired())){const e=t(c.key);if(e)return console.log("ðŸ“„ ä½¿ç”¨ç¼“å­˜æ•°æ®"),e}try{console.log("ðŸŒ å°è¯•ä»Žæœ¬åœ°è·¯å¾„èŽ·å–æœ€æ–°æ•°æ®...");const t=await e({url:s,method:"GET",timeout:1e4,header:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(200===t.statusCode&&t.data){console.log("âœ… GitHub æ•°æ®èŽ·å–æˆåŠŸ");const e=this.processNewsData(t.data);return a(c.key,e),i.updateCacheTime(),e}}catch(n){console.warn("âŒ GitHub æ•°æ®èŽ·å–å¤±è´¥:",n)}try{console.log("ðŸ“ å°è¯•å¯¼å…¥æœ¬åœ°æ•°æ®...");const t=await r(()=>import("./data-ai-news.BZm0eQTO.js"),[]),e=t.default||t;if(e&&e.data&&Array.isArray(e.data)){console.log("âœ… æœ¬åœ°æ•°æ®å¯¼å…¥æˆåŠŸ");const t=this.processNewsData(e);return a(c.key,t),i.updateCacheTime(),t}}catch(n){console.warn("âŒ æœ¬åœ°æ•°æ®å¯¼å…¥å¤±è´¥:",n)}try{console.log("ðŸ”— å°è¯•ä»Žæœ¬åœ°è·¯å¾„èŽ·å–æ•°æ®...");const t=await e({url:s,method:"GET",timeout:8e3});if(200===t.statusCode&&t.data){console.log("âœ… æœ¬åœ°è·¯å¾„æ•°æ®èŽ·å–æˆåŠŸ");const e=this.processNewsData(t.data);return a(c.key,e),i.updateCacheTime(),e}}catch(n){console.warn("âŒ æœ¬åœ°è·¯å¾„æ•°æ®èŽ·å–å¤±è´¥:",n)}const l=t(c.key);return l?(console.log("ðŸ“„ ä½¿ç”¨æ—§ç¼“å­˜æ•°æ®"),l):(console.log("âš ï¸ ä½¿ç”¨é»˜è®¤æ•°æ®"),this.getDefaultData())}catch(n){console.error("âŒ èŽ·å–æ–°é—»æ•°æ®å¤±è´¥:",n);const e=t(c.key);return e||this.getDefaultData()}}static processNewsData(t){const e=t.data||[],a=(new Date).toDateString(),r=e.filter(t=>new Date(t.publishTime).toDateString()===a).length,o=[...new Set(e.map(t=>t.category))],s=[...new Set(e.map(t=>t.source))];return{success:!0,updateTime:t.updateTime||(new Date).toISOString(),count:e.length,data:e,stats:{todayCount:r,totalCount:e.length,categories:o,sources:s}}}static async refreshNews(){return console.log("ðŸ”„ å¼ºåˆ¶åˆ·æ–°æ–°é—»æ•°æ®..."),this.getNews(!0)}static async searchNews(t,e){try{if(!e){e=(await this.getNews()).data}if(!t.trim())return e;const a=t.toLowerCase();return e.filter(t=>t.title.toLowerCase().includes(a)||t.content.toLowerCase().includes(a)||t.tags.some(t=>t.toLowerCase().includes(a))||t.source.toLowerCase().includes(a))}catch(a){return console.error("æœç´¢æ–°é—»å¤±è´¥:",a),[]}}static filterByCategory(t,e){return"å…¨éƒ¨"===e?t:t.filter(t=>t.category===e)}static getDefaultData(){return{success:!0,updateTime:(new Date).toISOString(),count:5,data:[{id:"demo-1",title:"AIæ–°é—»åŠ©æ‰‹æ•°æ®åŠ è½½ä¸­...",content:"æ­£åœ¨ä»Žè¿œç¨‹æ•°æ®æºèŽ·å–æœ€æ–°AIèµ„è®¯ï¼Œè¯·ç¨å€™...",originalContent:"æ­£åœ¨ä»Žè¿œç¨‹æ•°æ®æºèŽ·å–æœ€æ–°AIèµ„è®¯ï¼Œè¯·ç¨å€™...",source:"ç³»ç»Ÿæç¤º",sourceUrl:"https://ai-bot.cn/daily-ai-news/",publishTime:(new Date).toISOString(),crawlTime:(new Date).toISOString(),category:"ç³»ç»Ÿæ¶ˆæ¯",tags:["åŠ è½½ä¸­"],dateText:"ä»Šæ—¥"},{id:"demo-2",title:"æ•°æ®èŽ·å–ç­–ç•¥è¯´æ˜Ž",content:"æœ¬åº”ç”¨ä¼šä¼˜å…ˆä»Ž GitHub èŽ·å–æœ€æ–°æ•°æ®ï¼Œå¦‚æžœå¤±è´¥åˆ™ä½¿ç”¨æœ¬åœ°ç¼“å­˜æ•°æ®ï¼Œç¡®ä¿åœ¨å„ç§ç½‘ç»œçŽ¯å¢ƒä¸‹éƒ½èƒ½æ­£å¸¸è®¿é—®ã€‚",originalContent:"æœ¬åº”ç”¨ä¼šä¼˜å…ˆä»Ž GitHub èŽ·å–æœ€æ–°æ•°æ®ï¼Œå¦‚æžœå¤±è´¥åˆ™ä½¿ç”¨æœ¬åœ°ç¼“å­˜æ•°æ®ï¼Œç¡®ä¿åœ¨å„ç§ç½‘ç»œçŽ¯å¢ƒä¸‹éƒ½èƒ½æ­£å¸¸è®¿é—®ã€‚",source:"ç³»ç»Ÿè¯´æ˜Ž",sourceUrl:"https://ai-bot.cn/daily-ai-news/",publishTime:(new Date).toISOString(),crawlTime:(new Date).toISOString(),category:"ç³»ç»Ÿæ¶ˆæ¯",tags:["è¯´æ˜Ž"],dateText:"ä»Šæ—¥"}],stats:{todayCount:0,totalCount:2,categories:["ç³»ç»Ÿæ¶ˆæ¯"],sources:["ç³»ç»Ÿæç¤º","ç³»ç»Ÿè¯´æ˜Ž"]}}}}const l=(t,e)=>{const a=t.__vccOpts||t;for(const[r,o]of e)a[r]=o;return a};export{i as L,n as N,l as _};
