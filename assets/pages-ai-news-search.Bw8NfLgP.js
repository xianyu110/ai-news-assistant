import{d as e,r as s,c as a,o as l,g as t,f as c,w as o,i as r,h as u,j as n,k as i,l as f,I as d,n as g,m as _,q as v,F as y,u as h,t as p,S as k,x as m,s as C,z as w,H as L,J as T,A as x,y as $}from"./index-Bp6ppwUO.js";import{N as b,_ as M}from"./_plugin-vue_export-helper.DIRIpgiM.js";const A=M(e({__name:"search",setup(e){const M=s(""),A=s([]),I=s("å…¨éƒ¨"),z=s(!1),D=s(!1),H=s([]),j=s(["å…¨éƒ¨","æŠ•èèµ„","å¼€æºé¡¹ç›®","äº§å“å‘å¸ƒ","è¡Œä¸šåŠ¨æ€","æŠ€æœ¯ç ”ç©¶","ç»¼åˆèµ„è®¯"]),V=s(["AIæ¨¡å‹","å¤§è¯­è¨€æ¨¡å‹","ChatGPT","OpenAI","æŠ•èèµ„","å¼€æº","è°·æ­Œ","å¾®è½¯","ç™¾åº¦","æœºå™¨å­¦ä¹ ","æ·±åº¦å­¦ä¹ ","è‡ªç„¶è¯­è¨€å¤„ç†"]),E=a(()=>"å…¨éƒ¨"===I.value?A.value:A.value.filter(e=>e.category===I.value));l(()=>{R()});const N=()=>{},q=async()=>{const e=M.value.trim();if(e){z.value=!0,D.value=!0;try{console.log(`ğŸ” æœç´¢å…³é”®è¯: ${e}`);const s=await b.getNews();if(!s.success)throw new Error(s.error||"æœç´¢å¤±è´¥");{const a=s.data.filter(s=>{const a=s.title.toLowerCase().includes(e.toLowerCase()),l=s.content.toLowerCase().includes(e.toLowerCase()),t=s.tags&&s.tags.some(s=>s.toLowerCase().includes(e.toLowerCase())),c=s.source.toLowerCase().includes(e.toLowerCase());return a||l||t||c});A.value=a.sort((e,s)=>new Date(s.publishTime).getTime()-new Date(e.publishTime).getTime()),console.log(`âœ… æ‰¾åˆ° ${A.value.length} æ¡ç›¸å…³ç»“æœ`),P(e)}}catch(s){console.error("âŒ æœç´¢å¤±è´¥:",s),C({title:"æœç´¢å¤±è´¥",icon:"error"})}finally{z.value=!1}}},F=e=>{M.value=e,q()},G=e=>{if(!M.value||!e)return e;const s=M.value.trim(),a=new RegExp(`(${s})`,"gi");return e.replace(a,'<span style="color: #007aff; background-color: #f0f8ff;">$1</span>')},J=()=>{M.value="",A.value=[],D.value=!1},O=()=>{L()},P=e=>{try{const s=[e,...H.value.filter(s=>s!==e)];H.value=s.slice(0,10),T("search_history",H.value)}catch(s){console.error("ä¿å­˜æœç´¢å†å²å¤±è´¥:",s)}},R=()=>{try{const e=t("search_history");e&&Array.isArray(e)&&(H.value=e)}catch(e){console.error("åŠ è½½æœç´¢å†å²å¤±è´¥:",e)}},S=()=>{x({title:"æç¤º",content:"ç¡®å®šè¦æ¸…ç©ºæœç´¢å†å²å—ï¼Ÿ",success:e=>{e.confirm&&(H.value=[],$("search_history"),C({title:"å·²æ¸…ç©º",icon:"success"}))}})},U=e=>{if(!e)return"";const s=new Date(e),a=(new Date).getTime()-s.getTime(),l=Math.floor(a/6e4),t=Math.floor(a/36e5),c=Math.floor(a/864e5);return l<60?`${l}åˆ†é’Ÿå‰`:t<24?`${t}å°æ—¶å‰`:c<7?`${c}å¤©å‰`:`${s.getMonth()+1}æœˆ${s.getDate()}æ—¥`};return(e,s)=>{const a=u("uni-icons"),l=d,t=r,C=g,L=k;return n(),c(t,{class:"search-container"},{default:o(()=>[i(t,{class:"search-header"},{default:o(()=>[i(t,{class:"search-input-box"},{default:o(()=>[i(a,{type:"search",size:"18",color:"#999"}),i(l,{class:"search-input",modelValue:M.value,"onUpdate:modelValue":s[0]||(s[0]=e=>M.value=e),placeholder:"æœç´¢AIå¿«è®¯...",onInput:N,onConfirm:q,focus:""},null,8,["modelValue"]),M.value?(n(),c(t,{key:0,class:"clear-btn",onClick:J},{default:o(()=>[i(a,{type:"clear",size:"16",color:"#999"})]),_:1})):f("",!0)]),_:1}),i(C,{class:"cancel-btn",onClick:O},{default:o(()=>[_("å–æ¶ˆ")]),_:1})]),_:1}),A.value.length||D.value?f("",!0):(n(),c(t,{key:0,class:"search-suggestions"},{default:o(()=>[i(t,{class:"suggestion-section"},{default:o(()=>[i(C,{class:"section-title"},{default:o(()=>[_("çƒ­é—¨æœç´¢")]),_:1}),i(t,{class:"suggestion-tags"},{default:o(()=>[(n(!0),v(y,null,h(V.value,e=>(n(),c(C,{key:e,class:"suggestion-tag",onClick:s=>F(e)},{default:o(()=>[_(p(e),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1}),H.value.length?(n(),c(t,{key:0,class:"suggestion-section"},{default:o(()=>[i(t,{class:"section-header"},{default:o(()=>[i(C,{class:"section-title"},{default:o(()=>[_("æœç´¢å†å²")]),_:1}),i(C,{class:"clear-history",onClick:S},{default:o(()=>[_("æ¸…ç©º")]),_:1})]),_:1}),i(t,{class:"suggestion-tags"},{default:o(()=>[(n(!0),v(y,null,h(H.value,e=>(n(),c(C,{key:e,class:"suggestion-tag history-tag",onClick:s=>F(e)},{default:o(()=>[_(p(e),1)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})):f("",!0)]),_:1})),D.value?(n(),c(t,{key:1,class:"search-results"},{default:o(()=>[z.value?f("",!0):(n(),c(t,{key:0,class:"result-stats"},{default:o(()=>[i(C,{class:"stats-text"},{default:o(()=>[_(" æ‰¾åˆ° "+p(A.value.length)+" æ¡ç›¸å…³ç»“æœ ",1),M.value?(n(),c(C,{key:0},{default:o(()=>[_("ã€Œ"+p(M.value)+"ã€",1)]),_:1})):f("",!0)]),_:1})]),_:1})),i(t,{class:"filter-section"},{default:o(()=>[i(L,{"scroll-x":"true",class:"filter-scroll"},{default:o(()=>[i(t,{class:"filter-list"},{default:o(()=>[(n(!0),v(y,null,h(j.value,(e,s)=>(n(),c(t,{key:s,class:m(["filter-item",{active:I.value===e}]),onClick:s=>(e=>{I.value=e})(e)},{default:o(()=>[_(p(e),1)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})]),_:1}),i(t,{class:"results-list"},{default:o(()=>[(n(!0),v(y,null,h(E.value,(e,s)=>(n(),c(t,{key:e.id,class:"result-item",onClick:s=>(e=>{w({url:`/pages/ai-news/news-detail?id=${e.id}`})})(e)},{default:o(()=>[i(t,{class:"result-header"},{default:o(()=>{return[i(t,{class:m(["result-category",(s=e.category,{"æŠ•èèµ„":"category-finance","å¼€æºé¡¹ç›®":"category-opensource","äº§å“å‘å¸ƒ":"category-product","è¡Œä¸šåŠ¨æ€":"category-industry","æŠ€æœ¯ç ”ç©¶":"category-tech","ç»¼åˆèµ„è®¯":"category-general"}[s]||"category-default")])},{default:o(()=>[_(p(e.category),1)]),_:2},1032,["class"]),i(C,{class:"result-time"},{default:o(()=>[_(p(U(e.publishTime)),1)]),_:2},1024)];var s}),_:2},1024),i(t,{class:"result-title",innerHTML:G(e.title)},null,8,["innerHTML"]),i(t,{class:"result-content",innerHTML:G(e.content)},null,8,["innerHTML"]),e.tags&&e.tags.length?(n(),c(t,{key:0,class:"result-tags"},{default:o(()=>[(n(!0),v(y,null,h(e.tags.slice(0,3),e=>(n(),c(C,{key:e,class:"result-tag"},{default:o(()=>[_(p(e),1)]),_:2},1024))),128))]),_:2},1024)):f("",!0)]),_:2},1032,["onClick"]))),128)),z.value||0!==A.value.length?f("",!0):(n(),c(t,{key:0,class:"no-results"},{default:o(()=>[i(a,{type:"search",size:"60",color:"#ddd"}),i(C,{class:"no-results-text"},{default:o(()=>[_("æ²¡æœ‰æ‰¾åˆ°ç›¸å…³å†…å®¹")]),_:1}),i(C,{class:"no-results-tip"},{default:o(()=>[_("è¯•è¯•å…¶ä»–å…³é”®è¯")]),_:1})]),_:1}))]),_:1})]),_:1})):f("",!0),z.value?(n(),c(t,{key:2,class:"loading-state"},{default:o(()=>[i(a,{type:"spinner-cycle",size:"30",color:"#007aff"}),i(C,{class:"loading-text"},{default:o(()=>[_("æœç´¢ä¸­...")]),_:1})]),_:1})):f("",!0)]),_:1})}}}),[["__scopeId","data-v-07bf3e98"]]);export{A as default};
