import{d as e,r as a,c as t,o as s,a as l,b as n,e as c,s as o,f as u,w as r,i,g as d,h as f,j as v,k as g,l as _,m as h,t as w,n as y,F as p,p as m,q as b,u as k,v as C,x as D,y as F}from"./index-Byj_NXLU.js";import{N as $,L as T,_ as I}from"./_plugin-vue_export-helper.CgG7HaQr.js";const S=I(e({__name:"news-list",setup(e){const I=a(!1),S=a(!1),x=a([]),A=a({totalCount:0,todayCount:0,categories:[],sources:[]}),z=a(Date.now()),M=a(1),j=a(20),E=a(!0),N=a(null),O=a(!0),B=t(()=>{const e={};x.value.forEach(a=>{const t=new Date(a.publishTime),s=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`;e[s]||(e[s]=[]),e[s].push(a)});const a=Object.keys(e).sort((e,a)=>a.localeCompare(e)),t={};return a.forEach(a=>{t[a]=e[a].sort((e,a)=>new Date(a.publishTime).getTime()-new Date(e.publishTime).getTime())}),t});s(async()=>{await L(),q(),l(()=>{O.value=!0,q()}),n(()=>{O.value=!1,H()})}),c(()=>{H()});const q=()=>{H(),N.value=setInterval(async()=>{if(O.value){console.log("ğŸ”„ è‡ªåŠ¨åˆ·æ–°æ•°æ®...");try{const e=await $.getNews(!0);if(e.success&&e.data.length>0){const a=e.data||[];z.value=new Date(e.updateTime).getTime();(a.length>x.value.length||a.length>0&&x.value.length>0&&a[0].id!==x.value[0].id)&&(await Y(1,!0),o({title:"å‘ç°æ–°å†…å®¹",icon:"success",duration:1500}))}}catch(e){console.log("è‡ªåŠ¨åˆ·æ–°å¤±è´¥:",e)}}},6e5)},H=()=>{N.value&&(clearInterval(N.value),N.value=null)},L=async()=>{try{await Promise.all([Y(),G()])}catch(e){console.error("åˆå§‹åŒ–å¤±è´¥:",e),o({title:"åˆå§‹åŒ–å¤±è´¥",icon:"error"})}},P=async()=>{console.log("ğŸ”„ åˆ·æ–°æ–°é—»æ•°æ®..."),M.value=1,await Y(1,!0),await G(),o({title:"æ•°æ®å·²æ›´æ–°",icon:"success",duration:2e3})},Y=async(e=1,a=!1)=>{1===e?(I.value=!0,x.value=[],M.value=1,E.value=!0):S.value=!0;try{console.log("ğŸ“° å¼€å§‹åŠ è½½æ–°é—»æ•°æ®...");const t=await $.getNews(a);if(!t.success)throw new Error(t.error||"åŠ è½½å¤±è´¥");{const a=t.data||[];z.value=new Date(t.updateTime).getTime();const s=(e-1)*j.value,l=s+j.value,n=a.slice(s,l);x.value=1===e?n:[...x.value,...n],E.value=l<a.length,await J(),console.log(`âœ… æˆåŠŸåŠ è½½ ${n.length} æ¡æ–°é—»ï¼Œæ€»è®¡ ${x.value.length} æ¡`),1===e&&n.length>0&&o({title:`å·²åŠ è½½ ${n.length} æ¡æœ€æ–°å¿«è®¯`,icon:"success",duration:2e3})}}catch(t){console.error("âŒ åŠ è½½æ–°é—»å¤±è´¥:",t),o({title:"åŠ è½½å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•",icon:"error"})}finally{I.value=!1,S.value=!1}},G=async()=>{try{const e=await $.getNews();e.success&&(A.value=e.stats,console.log("ğŸ“Š ç»Ÿè®¡ä¿¡æ¯åŠ è½½æˆåŠŸ:",e.stats))}catch(e){console.error("âŒ åŠ è½½ç»Ÿè®¡å¤±è´¥:",e)}},J=async()=>{try{x.value.forEach(e=>{e.isFavorited=T.isFavorited(e.id)}),console.log("âœ… æ”¶è—çŠ¶æ€åŠ è½½æˆåŠŸ")}catch(e){console.error("âŒ åŠ è½½æ”¶è—çŠ¶æ€å¤±è´¥:",e)}},K=()=>{D({url:"/pages/ai-news/search"})},Q=()=>{F({title:"å…³æ³¨å…¬ä¼—å·",content:"è¯·åœ¨å¾®ä¿¡æœç´¢å¹¶å…³æ³¨å…¬ä¼—å·ã€ŒMaynorAIã€ï¼Œè·å–æ›´å¤šä¸€æ‰‹AIèµ„è®¯å’Œå·¥å…·ã€‚",showCancel:!1})},R=e=>{const a=new Date(e),t=new Date,s=new Date(t.getTime()-864e5),l=a.getMonth()+1,n=a.getDate(),c=["å‘¨æ—¥","å‘¨ä¸€","å‘¨äºŒ","å‘¨ä¸‰","å‘¨å››","å‘¨äº”","å‘¨å…­"][a.getDay()];return e===t.toISOString().split("T")[0]?`ä»Šå¤©Â·${c}`:e===s.toISOString().split("T")[0]?`æ˜¨å¤©Â·${c}`:`${l}æœˆ${n}æ—¥Â·${c}`},U=e=>{if(!e)return"";const a=new Date(e);return`${String(a.getHours()).padStart(2,"0")}:${String(a.getMinutes()).padStart(2,"0")}`};return(e,a)=>{const t=i,s=h,l=d("uni-icons"),n=C;return f(),u(t,{class:"news-container"},{default:r(()=>[v(t,{class:"header-banner"},{default:r(()=>[v(t,{class:"banner-bg"},{default:r(()=>[v(t,{class:"banner-content"},{default:r(()=>[v(t,{class:"banner-icon"},{default:r(()=>[v(t,{class:"news-icon"},{default:r(()=>[_("ğŸ“°")]),_:1})]),_:1}),v(t,{class:"banner-text"},{default:r(()=>[v(t,{class:"banner-title"},{default:r(()=>[_("æ¯æ—¥AIå¿«è®¯")]),_:1}),v(t,{class:"banner-subtitle"},{default:r(()=>[_("AIè¡Œä¸šèµ„è®¯ | çƒ­ç‚¹ | èèµ„ | äº§å“åŠ¨æ€")]),_:1})]),_:1})]),_:1})]),_:1}),v(t,{class:"description"},{default:r(()=>[_(" AIå·¥å…·é›†æ¯æ—¥å®æ—¶æ›´æ–° AI è¡Œä¸šçš„æœ€æ–°èµ„è®¯ã€æ–°é—»ã€çƒ­ç‚¹ã€èèµ„ã€äº§å“åŠ¨æ€ã€çˆ†æ–™ç­‰ï¼Œè®©ä½ éšæ—¶äº†è§£äººå·¥æ™ºèƒ½é¢†åŸŸæœ€æ–°è¶‹åŠ¿ã€æ›´æ–°çªç ´å’Œçƒ­é—¨å¤§äº‹ä»¶ã€‚ "),v(s,{class:"highlight",onClick:Q},{default:r(()=>[_("å…³æ³¨å…¬ä¼—å· MaynorAI")]),_:1}),_(" ï¼Œè·å–æœ€æ–°ä¸€æ‰‹ä¿¡æ¯ï¼ ")]),_:1})]),_:1}),v(t,{class:"search-section"},{default:r(()=>[v(t,{class:"search-box",onClick:K},{default:r(()=>[v(l,{type:"search",size:"16",color:"#999"}),v(s,{class:"search-placeholder"},{default:r(()=>[_("è¾“å…¥å…³é”®è¯æœç´¢å®šä½(ç²¾ç¡®åŒ¹é…)")]),_:1})]),_:1})]),_:1}),A.value.totalCount>0?(f(),u(t,{key:0,class:"stats-section"},{default:r(()=>[v(t,{class:"stats-item"},{default:r(()=>[v(s,{class:"stats-number"},{default:r(()=>[_(w(A.value.totalCount),1)]),_:1}),v(s,{class:"stats-label"},{default:r(()=>[_("æ€»å¿«è®¯")]),_:1})]),_:1}),v(t,{class:"stats-item"},{default:r(()=>[v(s,{class:"stats-number"},{default:r(()=>[_(w(A.value.todayCount),1)]),_:1}),v(s,{class:"stats-label"},{default:r(()=>[_("ä»Šæ—¥æ–°å¢")]),_:1})]),_:1}),v(t,{class:"stats-item"},{default:r(()=>[v(s,{class:"stats-number"},{default:r(()=>[_(w(Math.ceil((Date.now()-z.value)/1e3/60)),1)]),_:1}),v(s,{class:"stats-label"},{default:r(()=>[_("åˆ†é’Ÿå‰æ›´æ–°")]),_:1})]),_:1})]),_:1})):g("",!0),I.value&&0===x.value.length?(f(),u(t,{key:1,class:"loading-state"},{default:r(()=>[v(l,{type:"spinner-cycle",size:"30",color:"#4285F4"}),v(s,{class:"loading-text"},{default:r(()=>[_("æ­£åœ¨åŠ è½½æœ€æ–°å¿«è®¯...")]),_:1})]),_:1})):g("",!0),!I.value||x.value.length>0?(f(),u(t,{key:2,class:"news-list"},{default:r(()=>[(f(!0),y(p,null,m(B.value,(e,a)=>(f(),u(t,{key:a,class:"date-group"},{default:r(()=>[v(t,{class:"date-header"},{default:r(()=>[v(t,{class:"date-indicator"}),v(s,{class:"date-text"},{default:r(()=>[_(w(R(a)),1)]),_:2},1024)]),_:2},1024),v(t,{class:"date-news-list"},{default:r(()=>[(f(!0),y(p,null,m(e,(e,a)=>(f(),u(t,{key:e.id,class:"news-item",onClick:a=>(e=>{D({url:`/pages/ai-news/news-detail?id=${e.id}`})})(e)},{default:r(()=>[v(t,{class:"news-content"},{default:r(()=>[v(t,{class:"news-title"},{default:r(()=>[_(w(e.title),1)]),_:2},1024),v(t,{class:"news-meta"},{default:r(()=>[v(s,{class:"news-source"},{default:r(()=>[_("æ¥æºï¼š"+w(e.source),1)]),_:2},1024),v(s,{class:"news-time"},{default:r(()=>[_(w(U(e.publishTime)),1)]),_:2},1024)]),_:2},1024),e.tags&&e.tags.length>0?(f(),u(t,{key:0,class:"news-tags"},{default:r(()=>[(f(!0),y(p,null,m(e.tags.slice(0,3),e=>(f(),u(s,{key:e,class:"news-tag"},{default:r(()=>[_(w(e),1)]),_:2},1024))),128))]),_:2},1024)):g("",!0)]),_:2},1024),v(t,{class:"news-actions"},{default:r(()=>[v(t,{class:k(["favorite-btn",{favorited:e.isFavorited}]),onClick:b(a=>(e=>{try{e.isFavorited?(T.removeFavorite(e.id),e.isFavorited=!1,o({title:"å·²å–æ¶ˆæ”¶è—",icon:"success"})):(T.saveFavorite(e),e.isFavorited=!0,o({title:"å·²æ”¶è—",icon:"success"}))}catch(a){console.error("âŒ æ”¶è—æ“ä½œå¤±è´¥:",a),o({title:"æ“ä½œå¤±è´¥",icon:"error"})}})(e),["stop"])},{default:r(()=>[v(l,{type:e.isFavorited?"heart-filled":"heart",color:e.isFavorited?"#FF6B6B":"#CCC",size:"16"},null,8,["type","color"])]),_:2},1032,["class","onClick"])]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:2},1024)]),_:2},1024))),128))]),_:1})):g("",!0),S.value?(f(),u(t,{key:3,class:"load-more"},{default:r(()=>[v(l,{type:"spinner-cycle",size:"20",color:"#4285F4"}),v(s,{class:"load-more-text"},{default:r(()=>[_("æ­£åœ¨åŠ è½½æ›´å¤š...")]),_:1})]),_:1})):g("",!0),!E.value&&x.value.length>0?(f(),u(t,{key:4,class:"no-more"},{default:r(()=>[v(s,{class:"no-more-text"},{default:r(()=>[_("â€” å·²åŠ è½½å…¨éƒ¨å¿«è®¯ â€”")]),_:1})]),_:1})):g("",!0),I.value||0!==x.value.length?g("",!0):(f(),u(t,{key:5,class:"empty-state"},{default:r(()=>[v(l,{type:"info",size:"60",color:"#DDD"}),v(s,{class:"empty-text"},{default:r(()=>[_("æš‚æ— å¿«è®¯æ•°æ®")]),_:1}),v(n,{class:"refresh-btn",onClick:P},{default:r(()=>[_("åˆ·æ–°è¯•è¯•")]),_:1})]),_:1})),I.value?g("",!0):(f(),u(t,{key:6,class:"floating-refresh",onClick:P},{default:r(()=>[v(l,{type:"refresh",size:"20",color:"#4285F4"})]),_:1}))]),_:1})}}}),[["__scopeId","data-v-41631b36"]]);export{S as default};
